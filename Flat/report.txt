Необходимо создать функцию 
для обработки Excel-файла и создания отчета

inp_dir = r"D:\OneDrive\Документы" 
excel_file = "Flat_Arn.xlsx"
file_path = os.path.join(inp_dir, excel_file)
sheet_name = "Push"

Список столбцов файла формирующих отчет:
val_cell = ['El_bill','El_count','water','Wat_count','utilities','TV & Internet','litter','heating','Total']

список надписей в отчете соотвествующих значениям столбцов из списка val_cell
txt_list = ['Свет','Расх ээ','вода','Расх воды','квартплата' ,'TV', 'мусор', 'отопление','ВСЕГО']


title = "Коммунальные расходы за __ месяц ____ года"
пропуски для месяца и года  вставить из столбца 'Date' - исходного excel_file

выходной текст составить в порядке следования данных из val_cell c текстом из txt_list
при этом 
'Свет','Расх ээ'   - размещаются в одной строке 
'вода','Расх воды' - размещаются в следующей строке 
с подписями единиц измерения для 'Расх ээ'   квт-ч
для 'Расх воды'  - м3  ( метр кубический)
все остальные значения  'квартплата' , 'TV', , 'мусор', 'отопление','ВСЕГО' из столбцов
соотвественно 'utilities','TV & Internet','litter','heating','Total' выровнять по первому столбцу отчета
( второй столбец составят 'Расх ээ' 'Расх воды' для первых двух строк) 
в остальных строках второй столбец пуст

создать файл  отчета в форматах .txt  .pdf report_{suffix}.txt, report_{suffix}.pdf 
в каталоге inp_dir с суффиксом mm_year - месяц_год
взятым из столбца 'Date' 

данные из файла необходимо прочитать из последней строки
для 'El_count' и 'Wat_count'  необходимо вычислить расход воды и элктричества путем вычитания из значения 
этого столбца в последней строке ( показания счетчика за последний месяц минус показания счетчика за
предпоследний месяц, которые находятся строкой выше)


"Теперь, если в данных Excel есть пропущенные значения, они будут заменены на 0.00, и отчет будет выглядеть корректно. Проверьте,
 чтобы в исходных данных не было текста или других некорректных значений в числовых столбцах."

ты в своих рассуждениях не учитываешь тот факт что 
1) ДАННЫЕ У НАС ОДНИ И ТЕ ЖЕ 
2) в предыдущей версии они выводились правильно!!! 
3) в версии где ты исправил всего лишь вид отчета - данные выводятся неверно

ошибка внесена при кодировании между последней и предпоследней версиями кода. 
Проверка на отсутствие числового значения поэтому нам мало что дает

Мы пошли по неправильному пути 
и ошибка в выводе данных влияет на все уже работавшие до этого правильно, этапы - вывод 
отчета в пдф- файл работал правильно, а после неудачной редакторской правки 
и он перестал работать. 
Необходимо реструктурировать код таким образом, чтобы функция 
write_report_to_excel работала на том же уровне что и create_report
Вывод отчета в Excel файл - опция, которая может вызываться дополнительно к выводу в пдф файл. 
А что уже сделано - неприкосновенно! 








